{% for user_obj in users %}
<tr>
  <td>
    <strong>{{ user_obj.username }}</strong>
    {% if user_obj.is_superuser %}
      <span class="badge bg-danger ms-1">Superuser</span>
    {% endif %}
  </td>
  <td>
    {% if user_obj.first_name or user_obj.last_name %}
      {{ user_obj.first_name }} {{ user_obj.last_name }}
    {% else %}
      <span class="text-muted">-</span>
    {% endif %}
  </td>
  <td>{{ user_obj.email|default:"-" }}</td>
  <td>
    {% if user_obj.profile %}
      <span class="badge bg-primary">{{ user_obj.profile.get_role_display }}</span>
    {% elif user_obj.is_superuser %}
      <span class="badge bg-danger">Superusuario</span>
    {% else %}
      <span class="badge bg-secondary">Sin rol</span>
    {% endif %}
  </td>
  <td>
    {% if user_obj.profile and user_obj.profile.warehouse %}
      {{ user_obj.profile.warehouse.name }}
    {% else %}
      <span class="text-muted">-</span>
    {% endif %}
  </td>
  <td>
    {% if user_obj.is_active %}
      <span class="badge bg-success">Activo</span>
    {% else %}
      <span class="badge bg-secondary">Inactivo</span>
    {% endif %}
  </td>
  <td>
    <div class="btn-group btn-group-sm" role="group">
      <a href="{% url 'user_update' user_obj.pk %}" class="btn btn-outline-primary">
        Editar
      </a>
      <a href="{% url 'user_change_password' user_obj.pk %}" class="btn btn-outline-warning">
        Contrase√±a
      </a>
      {% if not user_obj.is_superuser or user_obj != user %}
      <a href="{% url 'user_delete' user_obj.pk %}" class="btn btn-outline-danger delete-user-btn" 
         data-user-id="{{ user_obj.pk }}"
         data-username="{{ user_obj.username }}">
        Eliminar
      </a>
      {% endif %}
    </div>
  </td>
</tr>
{% empty %}
<tr>
  <td colspan="7" class="text-center text-muted">
    No se encontraron usuarios.
  </td>
</tr>
{% endfor %}

